library(lm.beta) #standardized beta coefficients
library(lmtest) #Breusch-Pagan test for heterskedasticity
library(car) #VIF
library(sandwich) #robust standard errors
library(ggplot2)

#Define order of levels for categorical variables
df$group <- factor(df$group, levels = c("A", "B", "C"))

# Visualize Relationship
plot(jitter(df$x),jitter(df$y))

# Fit Lines
ggplot(df, aes(x = VARNAME, y = VARNAME)) +
  geom_point() +  # This adds the scatter points
  geom_smooth(method = "loess", se = FALSE) + 
  labs(x = "VARNAME", y = "VARNAME") +
  theme_minimal()  

# Correlation
cor.test(df$x,df$y,method="pearson") 

# Simple Regression
sreg <- lm(y ~ x 
                  , data = df)
summary(sreg)

poly <- lm(y ~ poly(x, degree = 2), data = df)  # Polynomial regression to assess nonlinearity
summary(poly)


#Specify Model
mod <- lm(y ~  x1 + as.factor(x2), 
                  data = df)
#diagnostics
vif(mod) #multicollinearity check
plot(mod, 1) 
bptest(mod) #heteroskedasticity check

#model summary
summary(mod) #unstandardized regression without robust standard errors

coeftest(mod, vcov = vcovHC(mod, type = "HC0")) #unstandardized reg w/ robust se

lm.beta(mod) #standardized coefficients













